 <!DOCTYPE html>
<html>
<head>
  <title>Modelo Keras convertido a TensorFlow.js</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.9.0"></script>
</head>
<body>
  <script type="text/javascript">
    // Definir la capa Rescaling como una capa personalizada en TensorFlow.js
    class Rescaling extends tf.layers.Layer {
      constructor(config) {
        super(config);
        this.scale = config.scale;
        this.offset = config.offset;
      }

      call(inputs, kwargs) {
        return tf.add(tf.mul(inputs[0], this.scale), this.offset);
      }

      computeOutputShape(inputShape) {
        return inputShape;
      }

      getConfig() {
        const config = super.getConfig();
        config.scale = this.scale;
        config.offset = this.offset;
        return config;
      }
    }

    // Registrar la capa personalizada
    tf.serialization.registerClass(Rescaling);

    async function runModel() {
      const model = await tf.loadLayersModel('model.json', {
        customObjects: { 'Rescaling': Rescaling } // Proporcionar la capa personalizada al cargar el modelo
      });
      console.log('Modelo cargado con éxito.');

      // Ejemplo de imagen de entrada
      const inputImage = tf.zeros([1, 256, 256, 3]);

      // Realizar la predicción con el modelo cargado
      const prediction = model.predict(inputImage);
      prediction.print();  // Muestra la salida del modelo

      // Si deseas utilizar el modelo para hacer predicciones en el navegador,
      // puedes llamar al método 'predict' con los datos de entrada adecuados.

      // Asegúrate de ajustar los datos de entrada según tus necesidades.
    }

    // Ejecuta la función de carga del modelo cuando se haya cargado el DOM
    document.addEventListener('DOMContentLoaded', runModel);
  </script>
</body>
</html>
